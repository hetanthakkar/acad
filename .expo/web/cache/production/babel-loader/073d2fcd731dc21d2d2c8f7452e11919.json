{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import PropTypes from'prop-types';import React from'react';import Linking from\"react-native-web/dist/exports/Linking\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import ParsedText from'react-native-parsed-text';import Communications from'react-native-communications';import{StylePropType}from\"./utils\";var WWW_URL_PATTERN=/^www\\./i;var textStyle={fontSize:16,lineHeight:20,marginTop:5,marginBottom:5,marginLeft:10,marginRight:10};var styles={left:StyleSheet.create({container:{},text:_objectSpread({color:'black'},textStyle),link:{color:'black',textDecorationLine:'underline'}}),right:StyleSheet.create({container:{},text:_objectSpread({color:'white'},textStyle),link:{color:'white',textDecorationLine:'underline'}})};var DEFAULT_OPTION_TITLES=['Call','Text','Cancel'];var MessageText=function(_React$Component){_inherits(MessageText,_React$Component);var _super=_createSuper(MessageText);function MessageText(){var _this;_classCallCheck(this,MessageText);_this=_super.apply(this,arguments);_this.onUrlPress=function(url){if(WWW_URL_PATTERN.test(url)){_this.onUrlPress(\"http://\"+url);}else{Linking.canOpenURL(url).then(function(supported){if(!supported){console.error('No handler for URL:',url);}else{Linking.openURL(url);}});}};_this.onPhonePress=function(phone){var optionTitles=_this.props.optionTitles;var options=optionTitles&&optionTitles.length>0?optionTitles.slice(0,3):DEFAULT_OPTION_TITLES;var cancelButtonIndex=options.length-1;_this.context.actionSheet().showActionSheetWithOptions({options:options,cancelButtonIndex:cancelButtonIndex},function(buttonIndex){switch(buttonIndex){case 0:Communications.phonecall(phone,true);break;case 1:Communications.text(phone);break;default:break;}});};_this.onEmailPress=function(email){return Communications.email([email],null,null,null,null);};return _this;}_createClass(MessageText,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps){return!!this.props.currentMessage&&!!nextProps.currentMessage&&this.props.currentMessage.text!==nextProps.currentMessage.text;}},{key:\"render\",value:function render(){var linkStyle=[styles[this.props.position].link,this.props.linkStyle&&this.props.linkStyle[this.props.position]];return React.createElement(View,{style:[styles[this.props.position].container,this.props.containerStyle&&this.props.containerStyle[this.props.position]]},React.createElement(ParsedText,{style:[styles[this.props.position].text,this.props.textStyle&&this.props.textStyle[this.props.position],this.props.customTextStyle],parse:[].concat(_toConsumableArray(this.props.parsePatterns(linkStyle)),[{type:'url',style:linkStyle,onPress:this.onUrlPress},{type:'phone',style:linkStyle,onPress:this.onPhonePress},{type:'email',style:linkStyle,onPress:this.onEmailPress}]),childrenProps:_objectSpread({},this.props.textProps)},this.props.currentMessage.text));}}]);return MessageText;}(React.Component);export{MessageText as default};MessageText.contextTypes={actionSheet:PropTypes.func};MessageText.defaultProps={position:'left',optionTitles:DEFAULT_OPTION_TITLES,currentMessage:{text:''},containerStyle:{},textStyle:{},linkStyle:{},customTextStyle:{},textProps:{},parsePatterns:function parsePatterns(){return[];}};MessageText.propTypes={position:PropTypes.oneOf(['left','right']),optionTitles:PropTypes.arrayOf(PropTypes.string),currentMessage:PropTypes.object,containerStyle:PropTypes.shape({left:StylePropType,right:StylePropType}),textStyle:PropTypes.shape({left:StylePropType,right:StylePropType}),linkStyle:PropTypes.shape({left:StylePropType,right:StylePropType}),parsePatterns:PropTypes.func,textProps:PropTypes.object,customTextStyle:StylePropType};","map":{"version":3,"sources":["../src/MessageText.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import PropTypes from 'prop-types';\nimport React from 'react';\nimport { Linking, StyleSheet, View, } from 'react-native';\n// @ts-ignore\nimport ParsedText from 'react-native-parsed-text';\nimport Communications from 'react-native-communications';\nimport { StylePropType } from './utils';\nconst WWW_URL_PATTERN = /^www\\./i;\nconst textStyle = {\n    fontSize: 16,\n    lineHeight: 20,\n    marginTop: 5,\n    marginBottom: 5,\n    marginLeft: 10,\n    marginRight: 10,\n};\nconst styles = {\n    left: StyleSheet.create({\n        container: {},\n        text: {\n            color: 'black',\n            ...textStyle,\n        },\n        link: {\n            color: 'black',\n            textDecorationLine: 'underline',\n        },\n    }),\n    right: StyleSheet.create({\n        container: {},\n        text: {\n            color: 'white',\n            ...textStyle,\n        },\n        link: {\n            color: 'white',\n            textDecorationLine: 'underline',\n        },\n    }),\n};\nconst DEFAULT_OPTION_TITLES = ['Call', 'Text', 'Cancel'];\nexport default class MessageText extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.onUrlPress = (url) => {\n            // When someone sends a message that includes a website address beginning with \"www.\" (omitting the scheme),\n            // react-native-parsed-text recognizes it as a valid url, but Linking fails to open due to the missing scheme.\n            if (WWW_URL_PATTERN.test(url)) {\n                this.onUrlPress(`http://${url}`);\n            }\n            else {\n                Linking.canOpenURL(url).then(supported => {\n                    if (!supported) {\n                        console.error('No handler for URL:', url);\n                    }\n                    else {\n                        Linking.openURL(url);\n                    }\n                });\n            }\n        };\n        this.onPhonePress = (phone) => {\n            const { optionTitles } = this.props;\n            const options = optionTitles && optionTitles.length > 0\n                ? optionTitles.slice(0, 3)\n                : DEFAULT_OPTION_TITLES;\n            const cancelButtonIndex = options.length - 1;\n            this.context.actionSheet().showActionSheetWithOptions({\n                options,\n                cancelButtonIndex,\n            }, (buttonIndex) => {\n                switch (buttonIndex) {\n                    case 0:\n                        Communications.phonecall(phone, true);\n                        break;\n                    case 1:\n                        Communications.text(phone);\n                        break;\n                    default:\n                        break;\n                }\n            });\n        };\n        this.onEmailPress = (email) => Communications.email([email], null, null, null, null);\n    }\n    shouldComponentUpdate(nextProps) {\n        return (!!this.props.currentMessage &&\n            !!nextProps.currentMessage &&\n            this.props.currentMessage.text !== nextProps.currentMessage.text);\n    }\n    render() {\n        const linkStyle = [\n            styles[this.props.position].link,\n            this.props.linkStyle && this.props.linkStyle[this.props.position],\n        ];\n        return (<View style={[\n            styles[this.props.position].container,\n            this.props.containerStyle &&\n                this.props.containerStyle[this.props.position],\n        ]}>\n        <ParsedText style={[\n            styles[this.props.position].text,\n            this.props.textStyle && this.props.textStyle[this.props.position],\n            this.props.customTextStyle,\n        ]} parse={[\n            ...this.props.parsePatterns(linkStyle),\n            { type: 'url', style: linkStyle, onPress: this.onUrlPress },\n            { type: 'phone', style: linkStyle, onPress: this.onPhonePress },\n            { type: 'email', style: linkStyle, onPress: this.onEmailPress },\n        ]} childrenProps={{ ...this.props.textProps }}>\n          {this.props.currentMessage.text}\n        </ParsedText>\n      </View>);\n    }\n}\nMessageText.contextTypes = {\n    actionSheet: PropTypes.func,\n};\nMessageText.defaultProps = {\n    position: 'left',\n    optionTitles: DEFAULT_OPTION_TITLES,\n    currentMessage: {\n        text: '',\n    },\n    containerStyle: {},\n    textStyle: {},\n    linkStyle: {},\n    customTextStyle: {},\n    textProps: {},\n    parsePatterns: () => [],\n};\nMessageText.propTypes = {\n    position: PropTypes.oneOf(['left', 'right']),\n    optionTitles: PropTypes.arrayOf(PropTypes.string),\n    currentMessage: PropTypes.object,\n    containerStyle: PropTypes.shape({\n        left: StylePropType,\n        right: StylePropType,\n    }),\n    textStyle: PropTypes.shape({\n        left: StylePropType,\n        right: StylePropType,\n    }),\n    linkStyle: PropTypes.shape({\n        left: StylePropType,\n        right: StylePropType,\n    }),\n    parsePatterns: PropTypes.func,\n    textProps: PropTypes.object,\n    customTextStyle: StylePropType,\n};\n//# sourceMappingURL=MessageText.js.map"]},"metadata":{},"sourceType":"module"}