{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\Users\\\\codemaxx\\\\Desktop\\\\iBlood\\\\mobileChat.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport BackHandler from \"react-native-web/dist/exports/BackHandler\";\nimport { Item, Input, Icon, Button, Header } from \"native-base\";\nimport Mycard from \"./mycard\";\nimport firebase from \"firebase\";\nvar firebaseConfig = {\n  apiKey: \"AIzaSyAfGN94rWhA55dceve-ab5R5nEL6o4xXeg\",\n  authDomain: \"new1-930be.firebaseapp.com\",\n  databaseURL: \"https://new1-930be.firebaseio.com\",\n  projectId: \"new1-930be\",\n  storageBucket: \"new1-930be.appspot.com\",\n  messagingSenderId: \"332990256430\",\n  appId: \"1:332990256430:web:640a6413492c34bf2a96bf\",\n  measurementId: \"G-SBPS6449GM\"\n};\n\nif (!firebase.apps.length) {\n  firebase.initializeApp(firebaseConfig);\n}\n\nvar messagesRecieved, k, seen, renderMessage;\nvar messages = [];\nvar temp = [];\nvar temp1 = [];\nvar temp2 = [];\nvar temp3 = [];\nvar temp4 = [];\nvar noOfMessagesRecieved, noOfMessagesSent;\nvar screenWidth = Math.round(Dimensions.get(\"window\").width) / 100;\nvar screenHeight = Math.round(Dimensions.get(\"window\").height) / 100;\n\nvar SearchScreen = function (_React$Component) {\n  _inherits(SearchScreen, _React$Component);\n\n  var _super = _createSuper(SearchScreen);\n\n  function SearchScreen() {\n    var _this;\n\n    _classCallCheck(this, SearchScreen);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      bar: \"\",\n      pub: [],\n      seen: [],\n      messages: [],\n      renderMessage: [],\n      temp3: [],\n      temp2: [],\n      temp: [],\n      temp1: [],\n      noOfMessagesRecieved: 0,\n      noOfMessagesSent: 0\n    };\n\n    _this.onChange = function _callee(bar) {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(_this.setState({\n                bar: bar\n              }));\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.handleBackButton = function () {\n      _this.props.navigation.navigate(\"Profile\");\n\n      return true;\n    };\n\n    return _this;\n  }\n\n  _createClass(SearchScreen, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      BackHandler.removeEventListener(\"hardwareBackPress\", this.handleBackButton);\n      this.setState({\n        messages: []\n      });\n      this.setState({\n        renderMessage: []\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var i, _i, _loop, _i2;\n\n      return _regeneratorRuntime.async(function componentDidMount$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              console.log(\"mudde\", this.props);\n              temp3 = this.state.temp3;\n              temp2 = this.state.temp2;\n              temp2 = this.state.temp1;\n              temp = this.state.temp;\n              BackHandler.addEventListener(\"hardwareBackPress\", this.handleBackButton);\n              _context5.next = 8;\n              return _regeneratorRuntime.awrap(this.setState({\n                currentId: 0\n              }));\n\n            case 8:\n              noOfMessagesSent = this.state.noOfMessagesSent;\n              _context5.next = 11;\n              return _regeneratorRuntime.awrap(firebase.database().ref(\"user/\" + 0 + \"/noOfMessagesSent\").on(\"value\", function _callee2(snapshot) {\n                return _regeneratorRuntime.async(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        noOfMessagesSent = snapshot.val();\n                        _context2.next = 3;\n                        return _regeneratorRuntime.awrap(_this2.setState({\n                          noOfMessagesSent: noOfMessagesSent\n                        }));\n\n                      case 3:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }));\n\n            case 11:\n              _context5.next = 13;\n              return _regeneratorRuntime.awrap(firebase.database().ref(\"user/\" + 0 + \"/messagesRecieved\").on(\"value\", function (snapshot) {\n                messagesRecieved = snapshot.val();\n              }));\n\n            case 13:\n              noOfMessagesRecieved = this.state.noOfMessagesRecieved;\n              _context5.next = 16;\n              return _regeneratorRuntime.awrap(firebase.database().ref(\"user/\" + 0 + \"/noOfMessagesRecieved\").on(\"value\", function _callee3(snapshot) {\n                return _regeneratorRuntime.async(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        noOfMessagesRecieved = snapshot.val();\n                        _context3.next = 3;\n                        return _regeneratorRuntime.awrap(_this2.setState({\n                          noOfMessagesRecieved: noOfMessagesRecieved\n                        }));\n\n                      case 3:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }));\n\n            case 16:\n              console.log(\"noOfMessagesSent\", this.state.noOfMessagesSent);\n              i = noOfMessagesSent;\n\n            case 18:\n              if (!(i >= 1)) {\n                _context5.next = 25;\n                break;\n              }\n\n              console.log(noOfMessagesSent);\n              _context5.next = 22;\n              return _regeneratorRuntime.awrap(firebase.database().ref(\"user/\" + 0 + \"/messagesSent/\" + i).on(\"value\", function (snapshot) {\n                if (!temp.includes(snapshot.val().message.to)) temp1.push(snapshot.val());\n                temp.push(snapshot.val().message.to);\n              }));\n\n            case 22:\n              i--;\n              _context5.next = 18;\n              break;\n\n            case 25:\n              console.log(temp1);\n              _i = noOfMessagesRecieved;\n\n            case 27:\n              if (!(_i >= 1)) {\n                _context5.next = 33;\n                break;\n              }\n\n              _context5.next = 30;\n              return _regeneratorRuntime.awrap(firebase.database().ref(\"user/\" + 0 + \"/messagesRecieved/\" + _i).on(\"value\", function (snapshot) {\n                if (!temp2.includes(snapshot.val().message.from)) {\n                  temp3.push(snapshot.val());\n                }\n\n                temp2.push(snapshot.val().message.from);\n              }));\n\n            case 30:\n              _i--;\n              _context5.next = 27;\n              break;\n\n            case 33:\n              messages = [].concat(_toConsumableArray(temp3), temp1);\n              messages = Object.keys(messages).sort(function (a, b) {\n                return Date.parse(messages[a].message.createdAt) - Date.parse(messages[b].message.createdAt);\n              }).map(function (k) {\n                return messages[k];\n              });\n              seen = this.state.seen;\n\n              for (k = messages.length - 1; k >= 0; k--) {\n                if (messages[k].message.from || messages[k].message.from == 0) {\n                  if (seen.includes(messages[k].message.from)) {\n                    messages.splice(k, 1);\n                  }\n\n                  seen.push(messages[k].message.from);\n                } else {\n                  if (seen.includes(messages[k].message.to)) {\n                    messages.splice(k, 1);\n                  }\n\n                  seen.push(messages[k].message.to);\n                }\n              }\n\n              messages = Object.keys(messages).sort(function (a, b) {\n                return Date.parse(messages[a].message.createdAt) - Date.parse(messages[b].message.createdAt);\n              }).map(function (k) {\n                return messages[k];\n              });\n              _context5.next = 40;\n              return _regeneratorRuntime.awrap(this.setState({\n                messages: messages\n              }));\n\n            case 40:\n              renderMessage = this.state.renderMessage;\n\n              _loop = function _loop(_i2) {\n                return _regeneratorRuntime.async(function _loop$(_context4) {\n                  while (1) {\n                    switch (_context4.prev = _context4.next) {\n                      case 0:\n                        if (!(_this2.state.messages[_i2].message.to || _this2.state.messages[_i2].message.to == 0)) {\n                          _context4.next = 5;\n                          break;\n                        }\n\n                        _context4.next = 3;\n                        return _regeneratorRuntime.awrap(firebase.database().ref(\"user/\" + _this2.state.messages[_i2].message.to).on(\"value\", function (snapshot) {\n                          renderMessage.push({\n                            name: snapshot.val().name,\n                            photo: snapshot.val().photo,\n                            chat: _this2.state.messages[_i2].message.text\n                          });\n                        }));\n\n                      case 3:\n                        _context4.next = 7;\n                        break;\n\n                      case 5:\n                        _context4.next = 7;\n                        return _regeneratorRuntime.awrap(firebase.database().ref(\"user/\" + _this2.state.messages[_i2].message.from).on(\"value\", function (snapshot) {\n                          renderMessage.push({\n                            name: snapshot.val().name,\n                            photo: snapshot.val().photo,\n                            chat: _this2.state.messages[_i2].message.text\n                          });\n                        }));\n\n                      case 7:\n                        _context4.next = 9;\n                        return _regeneratorRuntime.awrap(_this2.setState({\n                          renderMessage: renderMessage\n                        }));\n\n                      case 9:\n                      case \"end\":\n                        return _context4.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              };\n\n              _i2 = 0;\n\n            case 43:\n              if (!(_i2 < this.state.messages.length)) {\n                _context5.next = 49;\n                break;\n              }\n\n              _context5.next = 46;\n              return _regeneratorRuntime.awrap(_loop(_i2));\n\n            case 46:\n              _i2++;\n              _context5.next = 43;\n              break;\n\n            case 49:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(View, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 7\n        }\n      }, React.createElement(ScrollView, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 9\n        }\n      }, React.createElement(Header, {\n        searchBar: true,\n        rounded: true,\n        autoCorrect: false,\n        style: {\n          height: screenHeight * 12,\n          backgroundColor: \"#3498db\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }\n      }, React.createElement(Item, {\n        style: {\n          marginTop: -screenHeight * 2\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 13\n        }\n      }, React.createElement(Icon, {\n        name: \"ios-search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 15\n        }\n      }), React.createElement(Input, {\n        value: this.state.bar,\n        onChangeText: this.onChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 15\n        }\n      }), React.createElement(Icon, {\n        name: \"ios-people\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 15\n        }\n      }))), this.state.renderMessage.map(function (value) {\n        return React.createElement(TouchableOpacity, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 15\n          }\n        }, React.createElement(Mycard, {\n          name: value.name,\n          chat: value.chat,\n          photo: value.photo,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 17\n          }\n        }));\n      })));\n    }\n  }]);\n\n  return SearchScreen;\n}(React.Component);\n\nSearchScreen.navigationOptions = {\n  drawerLabel: \"search\"\n};\nexport { SearchScreen as default };","map":{"version":3,"sources":["C:/Users/codemaxx/Desktop/iBlood/mobileChat.js"],"names":["React","Item","Input","Icon","Button","Header","Mycard","firebase","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","apps","length","initializeApp","messagesRecieved","k","seen","renderMessage","messages","temp","temp1","temp2","temp3","temp4","noOfMessagesRecieved","noOfMessagesSent","screenWidth","Math","round","Dimensions","get","width","screenHeight","height","SearchScreen","state","bar","pub","onChange","setState","handleBackButton","props","navigation","navigate","BackHandler","removeEventListener","console","log","addEventListener","currentId","database","ref","on","snapshot","val","i","includes","message","to","push","from","Object","keys","sort","a","b","Date","parse","createdAt","map","splice","name","photo","chat","text","backgroundColor","marginTop","value","Component","navigationOptions","drawerLabel"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport {\r\n  Text,\r\n  View,\r\n  ScrollView,\r\n  Dimensions,\r\n  TouchableOpacity,\r\n  BackHandler,\r\n} from \"react-native\";\r\nimport { Item, Input, Icon, Button, Header } from \"native-base\";\r\nimport Mycard from \"./mycard\";\r\nimport firebase from \"firebase\";\r\nvar firebaseConfig = {\r\n  apiKey: \"AIzaSyAfGN94rWhA55dceve-ab5R5nEL6o4xXeg\",\r\n  authDomain: \"new1-930be.firebaseapp.com\",\r\n  databaseURL: \"https://new1-930be.firebaseio.com\",\r\n  projectId: \"new1-930be\",\r\n  storageBucket: \"new1-930be.appspot.com\",\r\n  messagingSenderId: \"332990256430\",\r\n  appId: \"1:332990256430:web:640a6413492c34bf2a96bf\",\r\n  measurementId: \"G-SBPS6449GM\",\r\n};\r\n\r\nif (!firebase.apps.length) {\r\n  firebase.initializeApp(firebaseConfig);\r\n}\r\nvar messagesRecieved, k, seen, renderMessage;\r\nvar messages = [];\r\nvar temp = [];\r\nvar temp1 = [];\r\nvar temp2 = [];\r\nvar temp3 = [];\r\nvar temp4 = [];\r\nvar noOfMessagesRecieved, noOfMessagesSent;\r\nconst screenWidth = Math.round(Dimensions.get(\"window\").width) / 100;\r\nconst screenHeight = Math.round(Dimensions.get(\"window\").height) / 100;\r\nexport default class SearchScreen extends React.Component {\r\n  state = {\r\n    bar: \"\",\r\n    pub: [],\r\n    seen: [],\r\n    messages: [],\r\n    renderMessage: [],\r\n    temp3: [],\r\n    temp2: [],\r\n    temp: [],\r\n    temp1: [],\r\n    noOfMessagesRecieved: 0,\r\n    noOfMessagesSent: 0,\r\n  };\r\n  static navigationOptions = {\r\n    drawerLabel: \"search\",\r\n  };\r\n  onChange = async (bar) => {\r\n    await this.setState({ bar: bar });\r\n  };\r\n  componentWillUnmount() {\r\n    BackHandler.removeEventListener(\"hardwareBackPress\", this.handleBackButton);\r\n    this.setState({ messages: [] });\r\n    this.setState({ renderMessage: [] });\r\n  }\r\n  handleBackButton = () => {\r\n    this.props.navigation.navigate(\"Profile\");\r\n    return true;\r\n  };\r\n\r\n  async componentDidMount() {\r\n    console.log(\"mudde\", this.props);\r\n    temp3 = this.state.temp3;\r\n    temp2 = this.state.temp2;\r\n    temp2 = this.state.temp1;\r\n    temp = this.state.temp;\r\n    BackHandler.addEventListener(\"hardwareBackPress\", this.handleBackButton);\r\n    await this.setState({ currentId: 0 });\r\n    noOfMessagesSent = this.state.noOfMessagesSent;\r\n    await firebase\r\n      .database()\r\n      .ref(\"user/\" + 0 + \"/noOfMessagesSent\")\r\n      .on(\"value\", async (snapshot) => {\r\n        noOfMessagesSent = snapshot.val();\r\n        await this.setState({ noOfMessagesSent });\r\n      });\r\n\r\n    await firebase\r\n      .database()\r\n      .ref(\"user/\" + 0 + \"/messagesRecieved\")\r\n      .on(\"value\", (snapshot) => {\r\n        messagesRecieved = snapshot.val();\r\n      });\r\n    noOfMessagesRecieved = this.state.noOfMessagesRecieved;\r\n    await firebase\r\n      .database()\r\n      .ref(\"user/\" + 0 + \"/noOfMessagesRecieved\")\r\n      .on(\"value\", async (snapshot) => {\r\n        // console.log(\"enterer\");\r\n        // console.log(noOfMessagesRecieved);\r\n        noOfMessagesRecieved = snapshot.val();\r\n        //  console.log(noOfMessagesRecieved);\r\n        await this.setState({ noOfMessagesRecieved });\r\n      });\r\n    console.log(\"noOfMessagesSent\", this.state.noOfMessagesSent);\r\n    for (let i = noOfMessagesSent; i >= 1; i--) {\r\n      console.log(noOfMessagesSent);\r\n      await firebase\r\n        .database()\r\n        .ref(\"user/\" + 0 + \"/messagesSent/\" + i)\r\n        .on(\"value\", (snapshot) => {\r\n          if (!temp.includes(snapshot.val().message.to))\r\n            temp1.push(snapshot.val());\r\n          temp.push(snapshot.val().message.to);\r\n        });\r\n    }\r\n    console.log(temp1);\r\n    //  console.log(\"noOfMessagesRecieved\", this.state.noOfMessagesRecieved);\r\n    for (let i = noOfMessagesRecieved; i >= 1; i--) {\r\n      //console.log(\"saldhashdiuashdiuashd\");\r\n      await firebase\r\n        .database()\r\n        .ref(\"user/\" + 0 + \"/messagesRecieved/\" + i)\r\n        .on(\"value\", (snapshot) => {\r\n          //    console.log(\"i is \", i);\r\n          //  console.log(snapshot.val().message);\r\n          if (!temp2.includes(snapshot.val().message.from)) {\r\n            //   console.log(\"object\");\r\n            temp3.push(snapshot.val());\r\n          }\r\n          temp2.push(snapshot.val().message.from);\r\n        });\r\n      //  console.log(\"returned\");\r\n    }\r\n    // console.log(\"alsjnoahndoashouashfoah\");\r\n    messages = [...temp3, ...temp1];\r\n    messages = Object.keys(messages)\r\n      .sort(\r\n        (a, b) =>\r\n          Date.parse(messages[a].message.createdAt) -\r\n          Date.parse(messages[b].message.createdAt)\r\n      )\r\n      .map((k) => messages[k]);\r\n\r\n    seen = this.state.seen;\r\n    for (k = messages.length - 1; k >= 0; k--) {\r\n      //   console.log(\"k\", k);\r\n      if (messages[k].message.from || messages[k].message.from == 0) {\r\n        if (seen.includes(messages[k].message.from)) {\r\n          messages.splice(k, 1);\r\n        }\r\n        //   console.log(seen);\r\n        seen.push(messages[k].message.from);\r\n        //  console.log(seen);\r\n      } else {\r\n        if (seen.includes(messages[k].message.to)) {\r\n          messages.splice(k, 1);\r\n        }\r\n        seen.push(messages[k].message.to);\r\n      }\r\n      // console.log(\" message  becomes\", messages);\r\n    }\r\n    //   console.log(messages);\r\n    messages = Object.keys(messages)\r\n      .sort(\r\n        (a, b) =>\r\n          Date.parse(messages[a].message.createdAt) -\r\n          Date.parse(messages[b].message.createdAt)\r\n      )\r\n      .map((k) => messages[k]);\r\n    await this.setState({ messages });\r\n    // console.log(\"ready\");\r\n    renderMessage = this.state.renderMessage;\r\n    for (let i = 0; i < this.state.messages.length; i++) {\r\n      if (\r\n        this.state.messages[i].message.to ||\r\n        this.state.messages[i].message.to == 0\r\n      ) {\r\n        // console.log(\"entered ti\");\r\n        await firebase\r\n          .database()\r\n          .ref(\"user/\" + this.state.messages[i].message.to)\r\n          .on(\"value\", (snapshot) => {\r\n            renderMessage.push({\r\n              name: snapshot.val().name,\r\n              photo: snapshot.val().photo,\r\n              chat: this.state.messages[i].message.text,\r\n            });\r\n          });\r\n      } else {\r\n        await firebase\r\n          .database()\r\n          .ref(\"user/\" + this.state.messages[i].message.from)\r\n          .on(\"value\", (snapshot) => {\r\n            renderMessage.push({\r\n              name: snapshot.val().name,\r\n              photo: snapshot.val().photo,\r\n              chat: this.state.messages[i].message.text,\r\n            });\r\n          });\r\n      }\r\n      //  console.log(\"alsjndkasndknkiu\");\r\n      await this.setState({ renderMessage });\r\n      //   console.log(this.state.renderMessage);\r\n    }\r\n    //  console.log(renderMessage);\r\n  }\r\n  render() {\r\n    return (\r\n      <View>\r\n        <ScrollView>\r\n          <Header\r\n            searchBar\r\n            rounded\r\n            autoCorrect={false}\r\n            style={{ height: screenHeight * 12, backgroundColor: \"#3498db\" }}\r\n          >\r\n            <Item style={{ marginTop: -screenHeight * 2 }}>\r\n              <Icon name=\"ios-search\" />\r\n              <Input value={this.state.bar} onChangeText={this.onChange} />\r\n              <Icon name=\"ios-people\" />\r\n            </Item>\r\n          </Header>\r\n          {this.state.renderMessage.map((value) => {\r\n            // console.log(value);\r\n            return (\r\n              <TouchableOpacity>\r\n                <Mycard\r\n                  name={value.name}\r\n                  chat={value.chat}\r\n                  photo={value.photo}\r\n                />\r\n              </TouchableOpacity>\r\n            );\r\n          })}\r\n        </ScrollView>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}